{
  "$schema": "https://json-schema.org/draft-07/schema#",
  "title": "RiskEvent",
  "description": "Deterministic risk detection event inside BAR M's insurance layer. Eliminates subjective terminology and enforces explicit on-chain risk criteria.",
  "type": "object",

  "properties": {
    "riskEventId": {
      "type": "string",
      "description": "Unique identifier for this risk event."
    },

    "businessId": {
      "type": "string",
      "description": "Business associated with the risk event."
    },

    "timestamp": {
      "type": "string",
      "format": "date-time",
      "description": "UTC timestamp when the event was detected."
    },

    "riskType": {
      "type": "string",
      "enum": [
        "REVENUE_VARIANCE",
        "COGS_VARIANCE",
        "EXPENSE_VARIANCE",
        "SETTLEMENT_FAILURE",
        "SMART_CONTRACT_FAILURE",
        "API_FAILURE",
        "DATA_MISMATCH",
        "SECURITY_EVENT",
        "SYSTEM_LATENCY_EXCEEDED",
        "INSURANCE_TRIGGER_EVENT"
      ],
      "description": "Enumerated risk classification. No free-text or narratives permitted."
    },

    "severityScore": {
      "type": "integer",
      "minimum": 0,
      "maximum": 10000,
      "description": "Deterministic risk score expressed in basis points (0â€“10,000). No subjective severity labels allowed."
    },

    "thresholds": {
      "type": "object",
      "description": "Explicit thresholds for severity classification.",
      "properties": {
        "minorBps": {
          "type": "integer",
          "description": "Basis point threshold for minor severity."
        },
        "majorBps": {
          "type": "integer",
          "description": "Basis point threshold for major severity."
        }
      },
      "required": [
        "minorBps",
        "majorBps"
      ]
    },

    "severityFlag": {
      "type": "string",
      "enum": [
        "WITHIN_TOLERANCE",
        "MINOR",
        "MAJOR"
      ],
      "description": "Deterministic severity classification based solely on severityScore vs thresholds."
    },

    "insuranceAction": {
      "type": "string",
      "enum": [
        "NONE",
        "MONITOR",
        "RESERVE_ADJUST",
        "PAYOUT_RESTRICTION",
        "INITIATE_PAYOUT",
        "TRIGGER_REINSURANCE"
      ],
      "description": "Enumerated action taken by the insurance layer. No subjective judgment permitted."
    },

    "source": {
      "type": "string",
      "enum": [
        "SYSTEM",
        "SMART_CONTRACT",
        "API",
        "MANUAL_ENTRY"
      ],
      "description": "Origin of the risk event."
    }
  },

  "required": [
    "riskEventId",
    "businessId",
    "timestamp",
    "riskType",
    "severityScore",
    "thresholds",
    "severityFlag",
    "insuranceAction",
    "source"
  ]
}
